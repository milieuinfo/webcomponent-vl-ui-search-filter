import{nativeVlElement,define}from"/node_modules/vl-ui-core/dist/vl-core.min.js";import"/node_modules/vl-ui-titles/dist/vl-titles.min.js";export class VlSearchFilter extends(nativeVlElement(HTMLDivElement)){static get _observedAttributes(){return["title"]}static get _observedClassAttributes(){return["alt","mobile-modal"]}constructor(){super(),this.observer=this.__observeChildElements((()=>this.__processClasses()))}connectedCallback(){this.__processClasses(),this.classList.add("vl-search-filter")}__observeChildElements(e){const t=new MutationObserver(e);return t.observe(this,{childList:!0}),t}disconnectedCallback(){this.observer.disconnect()}__processClasses(){this.querySelectorAll("form").forEach((e=>e.classList.add(`${this._elementPrefix}form`))),this.querySelectorAll("form > section").forEach((e=>e.classList.add(`${this._elementPrefix}section`))),this.querySelectorAll("form > section > h2").forEach((e=>e.classList.add(`${this._elementPrefix}section-title`))),this.querySelectorAll("form > section > div").forEach((e=>e.classList.add(`${this._elementPrefix}field`))),this.querySelectorAll("form > section > div > label").forEach((e=>e.classList.add(`${this._elementPrefix}field__label`))),this.querySelectorAll("form > div").forEach((e=>e.classList.add(`${this._elementPrefix}field`))),this._footerElement&&this._footerElement.classList.add(`${this._elementPrefix}footer`)}get formData(){return new FormData(this.querySelector("form"))}get _classPrefix(){return this._elementName+"--"}get _elementPrefix(){return this._elementName+"__"}get _elementName(){return"vl-search-filter"}get _titleElement(){return this._introElement||this._mobileModalTitleElement}get _introElement(){return this.querySelector(`.${this._elementPrefix}intro`)}get _headerElement(){return this.querySelector(`.${this._elementPrefix}header-modal`)}get _mobileModalTitleElement(){return this._headerElement?this._headerElement.querySelector("h2"):void 0}get _formElement(){return this.querySelector("form")}get _footerElement(){return this.querySelector(`form ~ div:not(.${this._elementPrefix}footer-modal):last-child`)}get _footerModalElement(){return this.querySelector(`.${this._elementPrefix}footer-modal`)}get _submitButton(){return this.getAttribute("data-vl-submit")?this.__submitButton(`#${this.getAttribute("data-vl-submit")}`):this.__submitButton("button",!0)}__submitButton(e,t=!1){if(this._formElement){let i;if(t){const t=this._formElement.querySelectorAll(e);i=t[t.length-1]}else i=this._formElement.querySelector(e);if(i)return i}if(this._footerModalElement){if(t){const t=this._footerModalElement.querySelectorAll(e);return t[t.length-1]}return this._footerModalElement.querySelector(e)}return null}get _title(){return this.getAttribute("data-vl-title")}get _mobileModalTitle(){return this.getAttribute("data-vl-mobile-modal-title")||this._title||"Filter"}_titleChangedCallback(e,t){null==this._titleElement?this.insertBefore(this.__createTitleElement(),this.firstChild):this._titleElement.textContent=t}_mobileModalTitleChangedCallback(e,t){this._mobileModalTitleElement&&(this._mobileModalTitleElement.textContent=t)}_mobileModalChangedCallback(e,t){null!=t?this.__enableModal():this.__disableModal()}__createTitleElement(){const e=document.createElement("p");return e.classList.add(`${this._elementPrefix}intro`),e.textContent=this._title,e}__enableModal(){this.__convertFooterToHeader(),this.__convertIntroToHeaderTitle(),this.__convertSubmitButtonContainerToModalFooter()}__disableModal(){this.__convertHeaderTitleToIntro(),this.__convertHeaderToFooter(),this.__convertModalFooterToSubmitButtonContainer()}__convertFooterToHeader(){const e=this._footerElement||document.createElement("div");this.__prepareMobileModal(e),this.insertBefore(e,this.firstChild)}__convertIntroToHeaderTitle(){const e=document.createElement("h2","vl-h2");e.textContent=this._mobileModalTitle,this._headerElement.insertBefore(e,this._headerElement.firstChild),this._introElement&&this._introElement.remove()}__convertSubmitButtonContainerToModalFooter(){this._submitButton&&(this.hidden=!1,this.__prepareSubmitButton(),this._submitButton.addEventListener("click",(()=>{this.removeAttribute("data-vl-mobile-modal"),this.hidden=!0}),{once:!0}),this._element.appendChild(this._submitButton.parentElement))}__convertHeaderTitleToIntro(){this._title&&this.insertBefore(this.__createTitleElement(),this.firstChild),this._mobileModalTitleElement.remove()}__convertHeaderToFooter(){const e=this._headerElement;e&&(this.__prepareMobileModal(e),this._element.appendChild(e))}__convertModalFooterToSubmitButtonContainer(){this._submitButton&&(this._formElement.appendChild(this._submitButton.parentElement),this.__prepareSubmitButton())}__prepareMobileModal(e){e.classList.toggle(`${this._elementPrefix}footer`),e.classList.toggle(`${this._elementPrefix}header-modal`),[...e.children].forEach((e=>e.classList.toggle(`${this._elementPrefix}header__clear`)))}__prepareSubmitButton(){this._submitButton.toggleAttribute("data-vl-block");const e=this._submitButton.parentElement;e.classList.toggle(`${this._elementPrefix}footer-modal`),e.classList.toggle(`${this._elementPrefix}field`)}}define("vl-search-filter",VlSearchFilter,{extends:"div"});